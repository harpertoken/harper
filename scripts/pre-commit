#!/bin/bash

# Pre-commit hook to run basic checks

echo "Running pre-commit checks..."

# Run cargo check
if ! cargo check; then
    echo "cargo check failed. Please fix the errors before committing."
    exit 1
fi

# Run clippy linting
if ! cargo clippy --all-targets --all-features --workspace -- -D warnings; then
    echo "cargo clippy failed. Please fix the warnings before committing."
    exit 1
fi

# Run YAML linting if yamllint is available
if command -v yamllint >/dev/null 2>&1; then
    echo "Running yamllint..."
    if ! yamllint .github/workflows/*.yml docker/docker-compose.yml; then
        echo "yamllint failed. Please fix the YAML issues before committing."
        echo "Install yamllint with: pip install yamllint"
        exit 1
    fi
else
    echo "yamllint not found. Install with: pip install yamllint"
fi

echo "Pre-commit checks passed."
exit 0